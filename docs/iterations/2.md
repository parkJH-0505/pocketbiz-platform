# Sprint 2: 핵심 점수화 엔진 구현 (2주)

## 목표
KPI 점수 계산 엔진 구축 및 API 구현

## 작업 목록

### 점수 계산 로직
- [ ] KPI 정규화 함수 구현 (0-100 변환) 🔴
  ```typescript
  function normalizeKPIScore(
    inputType: string,
    rawValue: any,
    stageRule: StageRule
  ): number {
    // 타입별 정규화 로직
  }
  ```

- [ ] 가중치 계산 로직 (x1/x2/x3) 🔴
  ```typescript
  function getWeightValue(weight: string): number {
    const weights = { x1: 1, x2: 2, x3: 3 };
    return weights[weight] || 1;
  }
  ```

- [ ] 축별 점수 집계 함수 🔴
- [ ] NA 처리 및 가중치 재분배 🔴
- [ ] 교차검증 규칙 엔진 🔴

### 6가지 입력 타입 파싱
- [ ] Numeric 타입 처리 🔴
  - 직접 입력값 검증
  - 범위 체크
  - 단위 변환

- [ ] Calculation 타입 수식 계산 🔴
  - 수식 파싱
  - 변수 참조 해석
  - 계산 실행

- [ ] Rubric 타입 점수 매핑 🔴
  - 선택값 → 점수 변환
  - 단계별 가중치 적용

- [ ] Stage 타입 단계별 점수 🔴
- [ ] Checklist 타입 Yes/No 처리 🔴
- [ ] MultiSelect 타입 가중치 합산 🔴

### API 엔드포인트
- [ ] POST /api/assessment/create - 새 진단 생성 🔴
  ```typescript
  interface CreateAssessmentRequest {
    organizationId: string;
    sector: string;
    stage: string;
  }
  ```

- [ ] PUT /api/assessment/{runId}/kpi - KPI 응답 저장 🔴
- [ ] GET /api/assessment/{runId}/score - 점수 계산 및 조회 🔴
- [ ] GET /api/kpi/library - KPI 목록 조회 🔴
- [ ] GET /api/kpi/{kpiId}/rules/{stage} - 단계별 규칙 조회 🔴

## 테스트 케이스
- [ ] Numeric 타입 점수 계산 테스트
- [ ] Calculation 타입 수식 파싱 테스트
- [ ] 가중치 재분배 로직 테스트
- [ ] API 통합 테스트

## 완료 기준
- [ ] 모든 입력 타입 점수 계산 가능
- [ ] API를 통한 점수 조회 가능
- [ ] 테스트 커버리지 80% 이상
- [ ] 점수 계산 속도 < 500ms