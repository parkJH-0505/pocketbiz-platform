# Iteration 23: VDR & MyProfile System Implementation

## Overview
Virtual Data Room (VDR) 및 MyProfile 시스템 구축 계획

### 목표
- **VDR**: 투자자용 문서 관리 중앙 허브
- **MyProfile**: 공개 기업 정보 페이지
- 모든 소스에서 문서 자동 집계
- 안전한 공유 세션 시스템

## System Architecture

### 1. VDR (Virtual Data Room)
**목적**: 투자자와의 문서 공유를 위한 중앙 집중식 문서 관리 시스템

#### 핵심 기능
- 자동 문서 집계 (Buildup, KPI, 수동 업로드)
- 대표 문서 지정 (IR Deck, 사업계획서, 재무제표, 마케팅 지표)
- 공유 세션 생성 및 관리
- 문서 검색 및 필터링
- 접근 권한 관리

#### 문서 소스
1. **Buildup Projects**: 프로젝트 산출물 자동 수집
2. **KPI Reports**: 진단 보고서 자동 포함
3. **Manual Uploads**: 사용자 직접 업로드
4. **Data Room**: 기존 자료실 연동 (향후)

### 2. MyProfile
**목적**: 공개 기업 프로필 및 기본 정보 관리

#### 핵심 기능
- 기업 기본 정보 관리
- 대표 이미지 및 로고
- 팀 구성원 정보
- 공개 성과 지표
- 연락처 정보

## Implementation Plan (10 Days)

### Phase 0: Foundation (Day 1-2)
**안전성 최우선**

#### Day 1: 기반 검증
- [ ] TypeScript 타입 정의 완성
- [ ] Error Boundary 구현
- [ ] 기존 시스템 의존성 검증
- [ ] Event namespace 정의

#### Day 2: Context 구조 확립
- [ ] VDRContext 완성
- [ ] MyProfileContext 생성
- [ ] Provider 계층 확정
- [ ] 상태 관리 패턴 정의

### Phase 1: Core VDR (Day 3-4)

#### Day 3: 기본 UI
- [ ] VDR 페이지 레이아웃
- [ ] 문서 목록 뷰
- [ ] 검색/필터 UI
- [ ] 대표 문서 섹션

#### Day 4: 기본 기능
- [ ] 파일 업로드
- [ ] 문서 삭제
- [ ] 카테고리 관리
- [ ] 태그 시스템

### Phase 2: Integration (Day 5-6)

#### Day 5: Buildup 연동
- [ ] Buildup 프로젝트 문서 자동 수집
- [ ] 프로젝트별 폴더 구조
- [ ] 산출물 메타데이터 동기화

#### Day 6: KPI 연동
- [ ] KPI 보고서 자동 포함
- [ ] 평가 결과 메타데이터
- [ ] 진단 이력 관리

### Phase 3: Sharing System (Day 7-8)

#### Day 7: 공유 세션
- [ ] 세션 생성 UI
- [ ] 링크 생성 및 관리
- [ ] 만료 기간 설정
- [ ] 접근 로그 추적

#### Day 8: 권한 관리
- [ ] 문서별 공개 범위 설정
- [ ] 세션별 문서 선택
- [ ] 워터마크 (향후)
- [ ] 다운로드 제어 (향후)

### Phase 4: MyProfile (Day 9)

#### Day 9: MyProfile 구현
- [ ] 프로필 편집 UI
- [ ] 대표 정보 관리
- [ ] 팀 멤버 관리
- [ ] 공개 URL 생성

### Phase 5: Polish & Testing (Day 10)

#### Day 10: 마무리
- [ ] UI/UX 개선
- [ ] 성능 최적화
- [ ] 에러 핸들링
- [ ] 통합 테스트

## Technical Specifications

### VDRDocument Type
```typescript
interface VDRDocument {
  id: string;
  name: string;
  path: string;
  size: number;
  uploadDate: Date;
  lastModified: Date;
  category: 'buildup_deliverable' | 'kpi_report' | 'vdr_upload' |
            'contract' | 'ir_deck' | 'business_plan' | 'financial' | 'marketing';
  source: 'buildup' | 'kpi' | 'manual' | 'dataroom';
  projectId?: string;
  projectName?: string;
  visibility: 'private' | 'team' | 'investors' | 'public';
  isRepresentative?: boolean;
  sharedSessions?: SharedSession[];
  tags?: string[];
  description?: string;
}
```

### SharedSession Type
```typescript
interface SharedSession {
  id: string;
  name: string; // e.g., "포켓전자 IR - YS캐피탈"
  createdAt: Date;
  expiresAt?: Date;
  accessCount: number;
  link: string;
  documentIds: string[];
  accessLog?: AccessLog[];
}
```

## Integration Points

### 1. BuildupContext
- 프로젝트 산출물 자동 수집
- 실시간 동기화
- 메타데이터 매핑

### 2. KPIDiagnosisContext
- 진단 보고서 자동 포함
- 평가 점수 연동
- 이력 관리

### 3. ScheduleContext (Future)
- 투자자 미팅 일정 연동
- 공유 세션 자동 생성
- 미팅 자료 준비 알림

### 4. NotificationContext
- 문서 업로드 알림
- 공유 세션 접근 알림
- 만료 예정 알림

## Safety Constraints

### Must NOT Break
1. **Phase Transition System (70% complete)**
   - Reducer 구조 유지
   - State 변경 금지
   - Event 충돌 방지

2. **ScheduleContext**
   - 기존 이벤트 구조 유지
   - 캘린더 통합 신중히 접근

3. **Provider Hierarchy**
   - BuildupProvider > VDRProvider 순서 유지
   - Context 의존성 준수

### Event Namespaces
- VDR: `vdr:*`
- MyProfile: `profile:*`
- 기존 시스템과 충돌 방지

## UI/UX Guidelines

### Design System
- Glassmorphism 일관성 유지
- 기존 컴포넌트 재사용
- 반응형 디자인 필수

### User Flow
1. VDR 접근 → 문서 목록 확인
2. 대표 문서 지정 → 카테고리별 관리
3. 공유 세션 생성 → 문서 선택 → 링크 생성
4. MyProfile 편집 → 공개 정보 관리

## Success Metrics

### 기능적 성공 지표
- [ ] 모든 Buildup 산출물 자동 수집
- [ ] KPI 보고서 자동 포함
- [ ] 공유 세션 정상 작동
- [ ] 대표 문서 4개 카테고리 완성

### 기술적 성공 지표
- [ ] 기존 시스템 무중단
- [ ] TypeScript 에러 0
- [ ] Console 에러 0
- [ ] 성능 저하 없음

## Risk Management

### High Risk
- Phase Transition 시스템 충돌
- Provider 순서 오류
- Event 네임스페이스 충돌

### Mitigation
- 철저한 의존성 검증
- 단계별 테스트
- 롤백 계획 수립

## Next Steps

### Immediate (Week 1)
1. VDRContext 완성 및 테스트
2. 기본 VDR 페이지 구현
3. 문서 자동 집계 검증

### Short-term (Week 2)
1. 공유 세션 시스템 구현
2. MyProfile 기본 구조
3. UI/UX 개선

### Long-term (Month 1+)
1. 워터마크 기능
2. 다운로드 제어
3. 투자자 분석 대시보드
4. ScheduleContext 연동

## Implementation Status (Updated: 2025-01-18)

### ✅ Fully Implemented (Complete)
#### 🎯 Priority 1: Critical MVP Features - **100% COMPLETE** ✅
- [x] **실제 파일 다운로드** - Blob 기반 다운로드, 단일/다중 파일 ZIP 지원
- [x] **드래그&드롭 업로드** - FileDropZone, 다중 파일, 진행률 표시
- [x] **문서 메타데이터 완성** - uploadedBy, 다운로드/조회 추적, 파일 검증

#### 🎯 Priority 2: Enhanced UX - **100% COMPLETE** ✅
- [x] **공유 세션 관리** - SessionManagementTab, 세션 목록/상세/수정
- [x] **접근 로그 시스템** - AccessLogViewer, 통계 대시보드, 실시간 추적
- [x] **문서 상세 모달** - DocumentDetailModal, 메타데이터/미리보기/편집

#### 문서 관리 기본
- [x] 파일 업로드 버튼 + 진행률 표시
- [x] 문서 목록 테이블 뷰
- [x] 문서 검색 및 실시간 필터링
- [x] 카테고리/프로젝트 필터
- [x] 다중 선택 시스템 + 벌크 작업
- [x] 키보드 단축키 (Ctrl+A, Ctrl+D, Delete)
- [x] 플로팅 액션 버튼 (공유/다운로드/삭제)

#### 대표 문서 시스템
- [x] 4개 카테고리 드롭존 (IR Deck, 사업계획서, 재무제표, 마케팅)
- [x] 드래그&드롭 지정 + 시각적 피드백
- [x] 대표 문서 별표 표시
- [x] 공개 범위 설정 (비공개/팀/투자자/공개)

#### 공유 세션 완전체
- [x] 세션 생성 UI 완성 (ShareSessionModal)
- [x] 만료 기간 설정 (7일/30일/커스텀/무제한)
- [x] 고급 설정 (접근 권한, 비밀번호)
- [x] 공유 링크 생성 및 복사
- [x] 세션 관리 탭 (SessionManagementTab)
- [x] 공유 문서 섹션 (SharedDocumentsSection)
- [x] 세션별 그룹화 + 확장/축소
- [x] 만료 상태 표시 + 링크 복사

#### 🎯 Priority 3: Advanced Features - **90% COMPLETE** ✅
- [x] **파일 미리보기** - DocumentPreview (PDF/이미지/텍스트/Office/비디오)
- [x] **태그 시스템** - 태그 추가/편집/삭제, 필터링
- [ ] **폴더 구조** - 트리 뷰, 폴더 관리 (아직 미완료)

#### 접근 로그 및 통계
- [x] 실시간 접근 로그 추적 (AccessLogViewer)
- [x] 사용자 정보 기록 (IP, User Agent, 디바이스)
- [x] 통계 대시보드 (조회/다운로드/공유 횟수)
- [x] 로그 필터링 및 검색
- [x] 액션별 아이콘 및 색상 구분

### ⚠️ Partially Implemented
- [x] 문서 자동 집계 (Mock 데이터로 완전 구현)
- [x] 파일 업로드 (localStorage → 완전 구현)
- [x] 문서 메타데이터 (모든 필드 구현 완료)

### ❌ Not Implemented
#### 🎯 Priority 3: 남은 기능
- [ ] **폴더 구조 시스템** - 폴더 생성/관리, 드래그&드롭 이동

#### 🎯 Priority 4: MyProfile System
- [ ] 기업 정보 관리 페이지
- [ ] 팀 멤버 관리
- [ ] 공개 URL 생성

#### 🎯 Priority 5: 장기 계획
- [ ] 워터마크 시스템
- [ ] NDA 체결 워크플로우
- [ ] AI 문서 분석

### 📊 Overall Completion: **85%** (Priority 1-2 완료, Priority 3 90% 완료)

## Technical Debt

### Current Issues
1. localStorage 임시 사용 → DB 연동 필요
2. Mock 데이터 사용 → 실제 API 연동 필요
3. 파일 업로드 로컬 처리 → 클라우드 스토리지 필요

### Resolution Plan
- Phase 1: 기능 완성 (localStorage)
- Phase 2: Backend API 설계
- Phase 3: Production 마이그레이션

## Documentation

### API Documentation
- VDRContext API
- SharedSession API
- MyProfile API

### User Guide
- VDR 사용 가이드
- 공유 세션 생성 방법
- MyProfile 설정 가이드

### Developer Guide
- Context 통합 방법
- Event 사용 규칙
- 컴포넌트 재사용 가이드

## Priority-Based Implementation Roadmap

### 🔴 Priority 1: Critical MVP Features ✅ **COMPLETED**
**Goal**: 실제 사용 가능한 파일 작업 기능 완성

1. ✅ **실제 파일 다운로드 구현**
   - ✅ Blob 기반 다운로드 로직
   - ✅ 단일 파일 다운로드
   - ✅ 다중 파일 ZIP 다운로드

2. ✅ **드래그&드롭 업로드 영역**
   - ✅ 파일 드롭존 UI (FileDropZone)
   - ✅ 다중 파일 동시 업로드
   - ✅ 업로드 진행률 표시 (UploadProgress)

3. ✅ **문서 메타데이터 완성**
   - ✅ uploadedBy 자동 채우기
   - ✅ 다운로드/조회 횟수 추적
   - ✅ 파일 크기/타입 검증

### 🟡 Priority 2: Enhanced UX ✅ **COMPLETED**
**Goal**: 사용성 개선 및 세션 관리 강화

4. ✅ **공유 세션 관리 페이지**
   - ✅ 세션 목록 테이블 (SessionManagementTab)
   - ✅ 세션 상세 정보
   - ✅ 세션 수정/삭제

5. ✅ **접근 로그 시스템**
   - ✅ 로그 기록 (timestamp, IP, user agent) (AccessLogViewer)
   - ✅ 로그 조회 UI + 필터링
   - ✅ 통계 대시보드

6. ✅ **문서 상세 모달**
   - ✅ 메타데이터 표시 (DocumentDetailModal)
   - ✅ 활동 히스토리
   - ✅ 빠른 작업 버튼 (다운로드/공유/삭제)

### 🟢 Priority 3: Advanced Features 🔶 **90% COMPLETED**
**Goal**: 고급 기능 추가

7. ✅ **파일 미리보기**
   - ✅ PDF 뷰어 (DocumentPreview)
   - ✅ 이미지 갤러리 (확대/회전)
   - ✅ Office 문서 미리보기
   - ✅ 텍스트/비디오 지원

8. ✅ **태그 시스템**
   - ✅ 태그 추가/제거 (DocumentDetailModal)
   - ✅ 태그별 필터
   - ✅ 실시간 편집

9. ❌ **폴더 구조** ⚠️ **REMAINING**
   - [ ] 트리 뷰 UI
   - [ ] 폴더 생성/관리
   - [ ] 드래그&드롭 이동

### 🔵 Priority 4: MyProfile System (2-3 days)
**Goal**: 기업 프로필 시스템 구축

10. **기업 정보 관리**
    - 회사 소개 편집
    - 로고/이미지 관리
    - 공개 설정

11. **팀 멤버 관리**
    - 멤버 추가/제거
    - 역할 설정
    - 프로필 사진

12. **공개 URL**
    - 커스텀 URL 생성
    - 공개 페이지 디자인
    - SEO 최적화

### ⚪ Priority 5: Nice-to-Have (Future)
**Goal**: 장기 개선 사항

13. **워터마크 시스템**
14. **NDA 체결 워크플로우**
15. **AI 문서 분석**
16. **블록체인 검증**
17. **실시간 협업 편집**

## Implementation Schedule

### ✅ Week 1 **COMPLETED**
- ✅ Day 1-2: Priority 1 완료 (파일 다운로드, 드래그&드롭)
- ✅ Day 3-4: Priority 2 완료 (세션 관리, 접근 로그)
- ✅ Day 5: Priority 3 대부분 완료 (미리보기, 태그)

### 🚧 Week 2 **IN PROGRESS**
- ⚠️ Day 1: Priority 3 완료 (폴더 구조) - **REMAINING**
- 🎯 Day 2-5: Priority 4 (MyProfile) 구현 - **NEXT UP**

### 📅 Week 3+ **PLANNED**
- Priority 5 기능들 점진적 추가
- 성능 최적화
- 사용자 피드백 반영

## Success Metrics

### ✅ 단기 목표 (1주) **ACHIEVED**
- ✅ 파일 업로드/다운로드 정상 작동
- ✅ 공유 세션 완벽 관리
- ✅ 접근 로그 추적 가능

### 🎯 중기 목표 (2주) **90% ACHIEVED**
- ✅ 문서 미리보기 지원
- ⚠️ MyProfile 기본 구조 완성 (예정)
- ✅ 태그 시스템 작동

### 📅 장기 목표 (1개월+) **ON TRACK**
- 🔶 전체 기능 완성도 85%+ (목표: 90%+)
- 🎯 사용자 만족도 4.5/5.0 (측정 예정)
- 🎯 성능 지표 달성 (로드 시간 <2초) (측정 예정)

---

*Last Updated: 2025-09-18*
*Author: PocketBiz Development Team*
*Status: Active Development - 85% Complete*

## 🎯 **현재 상황 요약 (2025-09-18)**

### ✅ **완료된 우선순위:**
- 🔴 **Priority 1** (Critical MVP) - **100% 완료**
- 🟡 **Priority 2** (Enhanced UX) - **100% 완료**
- 🟢 **Priority 3** (Advanced Features) - **90% 완료** (폴더 구조만 남음)

### 🎯 **다음 작업:**
1. **폴더 구조 시스템** (Priority 3 완성) - 1-2일
2. **MyProfile 시스템** (Priority 4) - 2-3일

### 🚀 **현재 사용 가능한 핵심 기능:**
- 완전한 문서 업로드/다운로드 시스템
- 공유 세션 생성 및 관리
- 문서 상세 모달 (미리보기, 편집, 통계)
- 접근 로그 및 분석 시스템
- 드래그앤드롭 대표 문서 지정
- 실시간 검색 및 필터링