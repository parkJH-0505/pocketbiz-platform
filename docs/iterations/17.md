# Sprint 17: KPI 진단 통합 페이지 (1주)

> 생성일: 2025-01-10
> PRD v4.0 기반

## 목표
Assessments와 Results 페이지를 하나의 통합된 KPI 진단 페이지로 재구성

## 배경
- 현재 평가(Assessments)와 결과(Results)가 분리되어 있어 사용자 경험 단절
- PRD v4.0에서 "KPI 진단"으로 통합 제안
- 탭 구조로 자연스러운 플로우 구현

## 작업 목록

### 1. 페이지 구조 설계 🔴

#### 컴포넌트 구조
```tsx
// pages/startup/KPIDiagnosis.tsx
<KPIDiagnosisPage>
  <TabNavigation>
    <Tab name="진단하기" />
    <Tab name="결과 보기" />
    <Tab name="상세 분석" />
    <Tab name="벤치마킹" />
    <Tab name="액션 플랜" />
  </TabNavigation>
  
  <TabContent>
    {activeTab === '진단하기' && <AssessmentPanel />}
    {activeTab === '결과 보기' && <ResultsPanel />}
    {activeTab === '상세 분석' && <DetailAnalysisPanel />}
    {activeTab === '벤치마킹' && <BenchmarkPanel />}
    {activeTab === '액션 플랜' && <ActionPlanPanel />}
  </TabContent>
</KPIDiagnosisPage>
```

### 2. 기존 컴포넌트 마이그레이션 🔴

#### Assessments → 진단하기 탭
- [ ] KPI 입력 폼 이동
- [ ] 진행률 표시 유지
- [ ] 임시 저장 기능 유지
- [ ] 완성도 체크 모달 유지

#### Results → 결과 보기 탭
- [ ] 레이더 차트 이동
- [ ] 종합 점수 표시
- [ ] AI 인사이트 이동
- [ ] 축별 점수 카드

### 3. 신규 탭 구현 🟡

#### 상세 분석 탭
```typescript
interface DetailAnalysis {
  axisBreakdown: {
    axis: AxisKey;
    score: number;
    kpis: KPIDetail[];
    trend: number[]; // 시계열 데이터
  }[];
  whatIfSimulation: {
    targetKPI: string;
    currentScore: number;
    simulatedScore: number;
    impact: number;
  };
}
```

- [ ] 축별 드릴다운 UI
- [ ] KPI별 상세 점수
- [ ] What-if 시뮬레이터
- [ ] 민감도 분석

#### 벤치마킹 탭
- [ ] 동일 군집 TOP 10% 비교
- [ ] 업계 평균 차트
- [ ] 성장 궤적 비교
- [ ] Best Practice 사례

#### 액션 플랜 탭
- [ ] 자동 생성 로드맵
- [ ] 우선순위 매트릭스
- [ ] 빌드업 프로그램 연결
- [ ] 예상 개선 효과

### 4. 상태 관리 통합 🔴

#### Context 재구성
```typescript
interface KPIDiagnosisContext {
  // 진단 데이터
  assessmentData: AssessmentData;
  
  // 결과 데이터
  resultsData: ResultsData;
  
  // 분석 데이터
  analysisData: AnalysisData;
  
  // 탭 상태
  activeTab: TabName;
  tabHistory: TabName[];
  
  // 액션
  saveAssessment: () => void;
  calculateResults: () => void;
  generateAnalysis: () => void;
}
```

### 5. 라우팅 및 리다이렉션 🔴

```tsx
// App.tsx
// 기존 경로 리다이렉션
<Route 
  path="/startup/assessments" 
  element={<Navigate to="/startup/kpi?tab=assess" />} 
/>
<Route 
  path="/startup/results" 
  element={<Navigate to="/startup/kpi?tab=results" />} 
/>

// 새 경로
<Route path="/startup/kpi" element={<KPIDiagnosis />} />
```

### 6. UX 개선사항 🟡

#### 탭 전환 로직
- [ ] 진단 완료 시 자동으로 결과 탭 이동
- [ ] 브레드크럼 네비게이션
- [ ] 탭별 완료 상태 표시
- [ ] 탭 간 데이터 동기화

#### 모바일 최적화
- [ ] 탭을 드롭다운으로 변환
- [ ] 스와이프 제스처로 탭 전환
- [ ] 세로 스크롤 최적화

## 기술 구현 사항

### 성능 최적화
```typescript
// 탭별 지연 로딩
const AssessmentPanel = lazy(() => import('./panels/AssessmentPanel'));
const ResultsPanel = lazy(() => import('./panels/ResultsPanel'));

// 메모이제이션
const memoizedResults = useMemo(() => 
  calculateResults(assessmentData), 
  [assessmentData]
);
```

### 데이터 캐싱
```typescript
// localStorage 활용
const CACHE_KEY = 'pocketbiz_kpi_diagnosis';

const saveToCache = (data: DiagnosisData) => {
  localStorage.setItem(CACHE_KEY, JSON.stringify({
    ...data,
    timestamp: Date.now()
  }));
};
```

## 테스트 계획

### 단위 테스트
- [ ] 각 탭 컴포넌트 렌더링
- [ ] 탭 전환 로직
- [ ] 데이터 흐름

### 통합 테스트
- [ ] 진단 → 결과 플로우
- [ ] 리다이렉션 동작
- [ ] 상태 동기화

### 사용자 테스트
- [ ] 탭 구조 직관성
- [ ] 로딩 시간
- [ ] 모바일 사용성

## 완료 기준

### 기능적 요구사항
- [ ] 모든 기존 기능 정상 작동
- [ ] 탭 전환 부드러움 (< 200ms)
- [ ] 데이터 무결성 유지
- [ ] 리다이렉션 정상 작동

### 비기능적 요구사항
- [ ] 페이지 로드 시간 < 2초
- [ ] 메모리 사용량 기존 대비 동일 이하
- [ ] 모바일 반응형 완벽 지원

## 일정

### Day 1-2: 구조 설계 및 셋업
- 페이지 구조 생성
- 라우팅 설정
- Context 구성

### Day 3-4: 컴포넌트 마이그레이션
- Assessments 이동
- Results 이동
- 상태 연결

### Day 5-6: 신규 탭 구현
- 상세 분석
- 벤치마킹
- 액션 플랜

### Day 7: 테스트 및 최적화
- 버그 수정
- 성능 최적화
- 사용자 테스트

## 리스크 및 대응

### 기술적 리스크
- **상태 관리 복잡도**: Context 분리 고려
- **성능 저하**: 코드 스플리팅 적용
- **데이터 동기화**: 중앙 상태 관리 강화

### UX 리스크
- **탭 구조 혼란**: 온보딩 툴팁 추가
- **모바일 경험**: 별도 모바일 뷰 고려

## 연관 작업
- Sprint 4: KPI 입력 시스템
- Sprint 5: 결과 시각화
- iteration-16: 전체 사용자 환경 고도화