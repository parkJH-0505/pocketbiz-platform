# Iteration 20: 프로젝트 상세 페이지 개선 및 시스템 통합

## 📅 작성일: 2025-01-17

## 🎯 목표
프로젝트 상세 페이지(ProjectDetail)를 개선하여 채팅 시스템 연동, 미팅 기록 관리, 단계 자동 전환, 실시간 활동 피드를 구현

## 📋 현재 상태 분석

### ✅ 구현 완료된 기능
1. **7단계 진행률 시스템**
   - 호버시 단계 정보 표시
   - 시각적 진행 표시

2. **기본 탭 구조**
   - 개요 탭: 프로젝트 통계, 활동 피드, 파일 목록
   - 파일 탭: 파일 업로드/다운로드 기능
   - 미팅 탭: 현재 "준비 중" 상태

3. **팀 멤버 표시**
   - PM 및 팀원 정보
   - 기본적인 팀 구성 표시

### ❌ 부족하거나 개선 필요 사항
1. 채팅 시스템 미연동
2. 미팅 기록 기능 미구현
3. 단계 전환 자동화 없음
4. 활동 피드가 하드코딩된 목업 데이터
5. 실시간 업데이트 부재

## 🔧 개선 작업 상세 계획

### 1. 채팅 시스템 연동
**목적**: 프로젝트별 채팅방과 상세 페이지 연결

**구현 내용**:
- 기존 "팀 메시지" 버튼 삭제
- 프로젝트 채팅방 바로가기 기능 추가
- 채팅방 내 읽지 않은 메시지 수 표시
- 위치: 상단 우측 액션 버튼 영역 또는 사이드바

**기술 구현**:
```typescript
// ChatContext 활용
const { openChatForProject, getUnreadCountByProject } = useChatContext();
```

### 2. 미팅 기록 시스템
**목적**: PM과 스타트업 간 미팅 내용 공유 및 피드백

**UI 구조**:
```
[미팅 회차 리스트] | [PM 작성 미팅 메모] | [댓글/피드백]
     (왼쪽)              (가운데)             (오른쪽)
```

**기능 상세**:
- **왼쪽 패널**:
  - 프리미팅
  - 가이드미팅 1차, 2차, 3차...
  - 회차별 날짜 표시

- **가운데 패널**:
  - PM이 작성한 미팅 메모 (읽기 전용)
  - 미팅 주요 논의사항
  - 결정사항 및 액션 아이템

- **오른쪽 패널**:
  - 스타트업 유저 댓글 작성
  - PM 확인 표시 기능
  - 타임스탬프 표시

**권한**:
- 스타트업 유저: 미팅 메모 읽기, 댓글 작성
- PM: 별도 환경에서 메모 작성, 댓글 확인

### 3. 단계 자동 전환 로직
**목적**: 미팅 및 계약 이벤트 기반 자동 단계 진행

**7단계 체계**:
1. **계약중** (contract_pending)
2. **계약완료** (contract_signed)
3. **기획** (planning)
4. **설계** (design)
5. **실행** (execution)
6. **검토** (review)
7. **완료** (completed)

**자동 전환 트리거**:

| 현재 단계 | 다음 단계 | 전환 조건 |
|---------|----------|----------|
| 계약중 | 계약완료 | 대금 지불 완료 확인 |
| 계약완료 | 기획 | 가이드미팅 1차 예약/진행 |
| 기획 | 설계 | 가이드미팅 2차 예약/진행 |
| 설계 | 실행 | 가이드미팅 3차 예약/진행 |
| 실행 | 검토 | 가이드미팅 4차 예약/진행 |
| 검토 | 완료 | 관리자 수동 완료 처리 |

**특수 케이스**:
- **계약중 진입 조건**:
  1. 오프라인 프리미팅 후 견적서 전달
  2. 온라인 장바구니에서 견적서 생성

- **미팅 명명 규칙**:
  - 프리미팅: 계약 전 킥오프
  - 가이드미팅 N차: 계약 후 진행 미팅

**구현 방법**:
```typescript
// 미팅 이벤트 리스너
const handleMeetingScheduled = (meeting: Meeting) => {
  if (meeting.type === 'guide' && meeting.round === 1) {
    updateProjectPhase('planning');
  }
  // ... 각 회차별 로직
};
```

### 4. 프로젝트 활동 피드 실시간화
**목적**: 실제 프로젝트 활동을 실시간으로 반영

**활동 유형**:
- 파일 업로드/수정/삭제
- 채팅 메시지
- 미팅 예약/완료
- 단계 전환
- 댓글 및 피드백
- 팀 멤버 변경

**구현 방식**:
- 기본 목업 데이터 (체험용)
- 실제 이벤트 로그 추가
- WebSocket 또는 Polling 방식 업데이트

**데이터 구조**:
```typescript
interface ProjectActivity {
  id: string;
  type: 'file_upload' | 'message' | 'phase_change' | 'meeting' | 'comment';
  category: '파일 활동' | '커뮤니케이션' | '프로젝트 진행';
  title: string;
  description: string;
  user: string;
  timestamp: Date;
  metadata?: any;
}
```

## 🚀 구현 우선순위

1. **Phase 1 - 채팅 연동** (즉시)
   - ProjectDetail에서 채팅방 접근
   - 읽지 않은 메시지 표시

2. **Phase 2 - 미팅 기록** (다음)
   - 미팅 탭 UI 구현
   - 댓글 시스템 구축

3. **Phase 3 - 단계 자동화** (후속)
   - 미팅 기반 단계 전환
   - 서버 이벤트 연동

4. **Phase 4 - 실시간 피드** (마지막)
   - 활동 로그 시스템
   - 실시간 업데이트

## 📝 주요 결정사항

### ❌ 제외된 기능
1. **마일스톤 기반 체크리스트**
   - PM에게 추가 업무 부담
   - 미팅 기반 진행으로 충분

2. **단계별 승인 프로세스**
   - 자동 전환이 기본
   - PM 수동 조정은 옵션

### ✅ 핵심 원칙
1. **간소화**: PM 업무 부담 최소화
2. **자동화**: 미팅/계약 기반 자동 진행
3. **투명성**: 스타트업에게 진행 상황 명확히 전달
4. **유연성**: PM 필요시 수동 조정 가능

## 🔄 시스템 통합 포인트

### BuildupContext와의 연동
- 프로젝트 단계 업데이트
- 미팅 일정 관리
- 파일 업로드 이벤트

### ChatContext와의 연동
- 프로젝트별 채팅방 접근
- 메시지 알림
- 시스템 메시지 (단계 변경 등)

### CalendarContext와의 연동
- 미팅 일정 표시
- 가이드미팅 회차 관리
- 자동 단계 전환 트리거

## 📊 예상 결과

### 사용자 경험 개선
- 프로젝트 진행 상황 실시간 확인
- PM과의 원활한 소통
- 미팅 내용 및 피드백 관리

### PM 업무 효율화
- 자동 단계 진행
- 중앙화된 커뮤니케이션
- 간소화된 프로젝트 관리

## 🔍 추가 고려사항

### 질문 및 확인 필요 사항
1. 미팅 메모는 PM이 어디서 작성? (관리자 페이지? 별도 PM 도구?)
2. 가이드미팅 회차와 단계 매칭이 항상 고정?
3. 채팅 버튼 최적 위치? (상단 액션바? 사이드바? 플로팅?)

### 기술적 과제
- 실시간 업데이트 구현 방식 (WebSocket vs Polling)
- 서버 로그 이벤트 구조 설계
- PM 도구와의 API 연동

## 📅 타임라인
- Phase 1 (채팅 연동): 즉시 시작
- Phase 2 (미팅 기록): 1-2일
- Phase 3 (단계 자동화): 2-3일
- Phase 4 (실시간 피드): 3-4일

---

**다음 단계**: Phase 1 채팅 시스템 연동 구현 시작